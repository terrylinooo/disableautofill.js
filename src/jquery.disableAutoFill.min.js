(function($){'use strict';var realPasswordMapper={};var realFields=[];var realFieldsMapper={};var _helper={};Array.prototype.insert=function(index,item){this.splice(index,0,item)};_helper.passwordListener=function(obj,settings){var passObj=(settings.passwordField==='')?'.disabledAutoFillPassword':settings.passwordField;if(obj.find('[type=password]').length>0){obj.find('[type=password]').attr('type','text').addClass('disabledAutoFillPassword')}
obj.on('keyup',passObj,function(){if(!realPasswordMapper.hasOwnProperty(this.id))
realPasswordMapper[this.id]=[];var realPassword=realPasswordMapper[this.id];var tmpPassword=$(this).val();var passwordLen=tmpPassword.length;var currKeyupPos=this.selectionStart;for(var i=0;i<passwordLen;i++){if(tmpPassword[i]!=='*'){realPassword[i]=tmpPassword[i]}}
if(passwordLen<realPassword.length){var diff=realPassword.length-passwordLen;var key=event.keyCode||event.charCode;if(key==8||key==46){realPassword.splice(currKeyupPos,diff)}
else{realPassword.splice(currKeyupPos-1,diff+1);realPassword.insert(currKeyupPos-1,tmpPassword[currKeyupPos-1])}}
$(this).val(tmpPassword.replace(/./g,'*'));if(settings.debugMode){console.log('Current keyup position: '+currKeyupPos);console.log('Password length: '+passwordLen);console.log('Real password:');console.log(realPassword)}})}
_helper.formSubmitListener=function(obj,settings){var btnObj=(settings.submitButton=='')?'.disableAutoFillSubmit':settings.submitButton;obj.on('click',btnObj,function(event){_helper.restoreInput(obj,settings);if(settings.callback.call()){if(settings.debugMode){console.log(obj.serialize())}else{if(settings.html5FormValidate){$(btnObj).attr('type','submit').trigger('submit');setTimeout(function(){$(btnObj).attr('type','button')},1000)}else{obj.submit()}}}})};_helper.randomizeInput=function(obj,settings){obj.find('input').each(function(i){realFields[i]=$(this).attr('name');if(realFieldsMapper[realFields[i]]){$(this).attr('name',realFieldsMapper[realFields[i]])}else{var randomName=Math.random().toString(36).replace(/[^a-z]+/g,'');$(this).attr('name',randomName);realFieldsMapper[realFields[i]]=randomName}})};_helper.restoreInput=function(obj,settings){if(settings.randomizeInputName){obj.find('input').each(function(i){$(this).attr('name',realFields[i])})}
if(settings.textToPassword){obj.find(settings.passwordField).attr('type','password')}
obj.find(settings.passwordField).each(function(i,pwf){$(pwf).val(realPasswordMapper[pwf.id].join(''))})};$.fn.disableAutoFill=function(options){var settings=$.extend({},$.fn.disableAutoFill.defaults,options);this.attr('autocomplete','off');if(this.find('[type=submit]').length>0){this.find('[type=submit]').addClass('disableAutoFillSubmit').attr('type','button')}
if(settings.submitButton!=''){this.find(settings.submitButton).addClass('disableAutoFillSubmit').attr('type','button')}
if(settings.randomizeInputName){_helper.randomizeInput(this,settings)}
_helper.passwordListener(this,settings);_helper.formSubmitListener(this,settings)};$.fn.disableAutoFill.defaults={debugMode:!1,textToPassword:!0,randomizeInputName:!0,passwordField:'',html5FormValidate:!1,submitButton:'',callback:function(){return!0},}})(jQuery)
